<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikFinity - Setup</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #0f0f0f; color: #fff; }
        
        .sidebar { position: fixed; left: 0; top: 0; width: 250px; height: 100vh; background: #1a1a1a; border-right: 1px solid #333; overflow-y: auto; z-index: 100; }
        .sidebar-header { padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .sidebar-header h2 { font-size: 1.5em; }
        
        .menu-item { padding: 15px 20px; cursor: pointer; transition: all 0.3s; border-left: 3px solid transparent; display: flex; align-items: center; gap: 12px; }
        .menu-item:hover { background: #252525; border-left-color: #667eea; }
        .menu-item.active { background: #252525; border-left-color: #667eea; color: #667eea; }
        
        .main-content { margin-left: 250px; padding: 30px; min-height: 100vh; }
        
        .setup-card { background: #1a1a1a; padding: 30px; border-radius: 12px; margin-bottom: 20px; }
        .setup-card h2 { margin-bottom: 10px; color: #667eea; }
        .setup-card p { color: #888; margin-bottom: 20px; }
        
        .form-group { margin-bottom: 25px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; }
        .form-group input { width: 100%; max-width: 400px; padding: 12px; border: 1px solid #333; background: #252525; color: #fff; border-radius: 8px; font-size: 1em; }
        .form-group input:focus { outline: none; border-color: #667eea; }
        
        .btn { padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 1em; transition: all 0.3s; }
        .btn-primary { background: #667eea; color: white; }
        .btn-primary:hover { background: #5568d3; transform: translateY(-2px); }
        .btn-success { background: #10b981; color: white; }
        
        .tiktok-connect { background: #000; color: white; display: flex; align-items: center; gap: 10px; }
        .tiktok-connect:hover { background: #111; }
        
        .info-box { background: #252525; padding: 15px; border-radius: 8px; border-left: 4px solid #667eea; margin-top: 15px; }
        .info-box p { color: #aaa; margin: 0; font-size: 0.9em; }
        
        .status-indicator { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 8px; }
        .status-connected { background: #10b981; }
        .status-disconnected { background: #ef4444; }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>üé• TikFinity</h2>
            <p style="font-size: 0.85em; opacity: 0.9;">Live Stream Manager</p>
        </div>
        
        <div style="padding: 15px 20px; color: #888; font-size: 0.75em; text-transform: uppercase;">START</div>
        <div class="menu-item active">
            <i class="fas fa-cog"></i> Setup
        </div>
        
        <div style="height: 1px; background: #333; margin: 15px 0;"></div>
        <div style="padding: 10px 20px; color: #888; font-size: 0.75em;"><i class="fas fa-desktop"></i></div>
        
        <div class="menu-item" onclick="goToDashboard()">
            <i class="fas fa-th-large"></i> Dashboard
        </div>
        <div class="menu-item">
            <i class="fas fa-layer-group"></i> Overlay Gallery
        </div>
        <div class="menu-item">
            <i class="fas fa-bullseye"></i> Goal Overlays
        </div>
        <div class="menu-item">
            <i class="fas fa-gift"></i> Gift Overlays
        </div>
        
        <div style="height: 1px; background: #333; margin: 15px 0;"></div>
        <div style="padding: 10px 20px; color: #888; font-size: 0.75em;"><i class="fas fa-bolt"></i></div>
        
        <div class="menu-item">
            <i class="fas fa-volume-up"></i> Sound Alerts
        </div>
        <div class="menu-item" onclick="location.href='/tiktok/automations/'">
            <i class="fas fa-robot"></i> Actions & Events
        </div>
        
        <div style="height: 1px; background: #333; margin: 15px 0;"></div>
        <div style="padding: 10px 20px; color: #888; font-size: 0.75em;"><i class="far fa-comments"></i></div>
        
        <div class="menu-item">
            <i class="fas fa-terminal"></i> Chat Commands
        </div>
        <div class="menu-item">
            <i class="fas fa-robot"></i> Chatbot
        </div>
        <div class="menu-item">
            <i class="fas fa-microphone"></i> TTS Chat
        </div>
        
        <div style="height: 1px; background: #333; margin: 15px 0;"></div>
        <div style="padding: 10px 20px; color: #888; font-size: 0.75em;"><i class="fas fa-list-ul"></i></div>
        
        <div class="menu-item">
            <i class="fas fa-users"></i> User & Points
        </div>
        <div class="menu-item">
            <i class="fas fa-exchange-alt"></i> Transactions
        </div>
        
        <div style="height: 1px; background: #333; margin: 15px 0;"></div>
        <div style="padding: 10px 20px; color: #888; font-size: 0.75em;"><i class="fas fa-gamepad"></i></div>
        
        <div class="menu-item">
            <i class="fas fa-heart"></i> Likeathon
        </div>
        <div class="menu-item">
            <i class="fas fa-clock"></i> Timer
        </div>
        <div class="menu-item">
            <i class="fas fa-circle-notch"></i> Wheel of Fortune
        </div>
        
        <div style="height: 1px; background: #333; margin: 15px 0;"></div>
        <div style="padding: 10px 20px; color: #888; font-size: 0.75em;"><i class="fas fa-tools"></i></div>
        
        <div class="menu-item">
            <i class="fas fa-trophy"></i> Challenge
        </div>
        <div class="menu-item">
            <i class="fas fa-chart-line"></i> Halving
        </div>
    </div>
    
    <div class="main-content">
        <h1 style="font-size: 2em; margin-bottom: 30px;">Setup</h1>
        <p style="color: #888; margin-bottom: 30px;">Here you can define the basic settings.</p>
        
        <!-- TikTok Name -->
        <div class="setup-card">
            <h2>Your TikTok Name <span style="color: #ef4444;">*</span></h2>
            <p>Enter your TikTok username to start monitoring your live streams</p>
            
            <div class="form-group">
                <label>TikTok Username</label>
                <input type="text" id="tiktokUsername" placeholder="@username" value="{{ tiktok_username }}">
            </div>
            
            <button class="btn btn-primary" onclick="saveTikTokUsername()">
                <i class="fas fa-save"></i> Save Username
            </button>
            
            <div class="info-box">
                <p><i class="fas fa-info-circle"></i> This is required to connect to your TikTok live streams. You can change it anytime.</p>
            </div>
        </div>
        
        <!-- TikTok OAuth -->
        <div class="setup-card">
            <h2>TikTok Account Connection</h2>
            <p>Connect your TikTok account for enhanced features (Optional)</p>
            
            <div style="margin-bottom: 15px;">
                <span class="status-indicator {% if user.is_authenticated %}status-connected{% else %}status-disconnected{% endif %}"></span>
                <span>{% if user.is_authenticated %}Connected as {{ user.username }}{% else %}Not Connected{% endif %}</span>
            </div>
            
            {% if not user.is_authenticated %}
            <a href="{% url 'tiktok_live:tiktok_oauth_login' %}" class="btn tiktok-connect" style="text-decoration: none;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/>
                </svg>
                Connect with TikTok
            </a>
            {% else %}
            <button class="btn btn-success" disabled>
                <i class="fas fa-check"></i> Connected
            </button>
            <a href="{% url 'tiktok_live:logout' %}" class="btn" style="background: #ef4444; color: white; text-decoration: none; margin-left: 10px;">
                <i class="fas fa-sign-out-alt"></i> Disconnect
            </a>
            {% endif %}
            
            <div class="info-box">
                <p><i class="fas fa-info-circle"></i> Connecting your TikTok account is optional. You can use TikFinity without logging in by just entering your username above.</p>
            </div>
        </div>
        
        <!-- Points System -->
        <div class="setup-card">
            <h2>Points System</h2>
            <p>Configure your points and rewards system</p>
            
            <div class="form-group">
                <label>Name of your currency</label>
                <input type="text" placeholder="Points" value="Points">
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; max-width: 600px;">
                <div class="form-group">
                    <label>Comment Points</label>
                    <input type="number" value="1" min="0">
                </div>
                <div class="form-group">
                    <label>Like Points</label>
                    <input type="number" value="3" min="0">
                </div>
                <div class="form-group">
                    <label>Gift Points</label>
                    <input type="number" value="0.5" min="0" step="0.1">
                </div>
            </div>
        </div>
        
        <!-- Subscriber Bonus -->
        <div class="setup-card">
            <h2>Subscriber Bonus</h2>
            <p>If you have subscribers, you can set a points multiplier for them</p>
            
            <div class="form-group">
                <label>Subscriber Bonus Ratio</label>
                <input type="number" value="0" min="0" max="100" style="max-width: 200px;"> %
            </div>
        </div>
        
        <!-- Level Settings -->
        <div class="setup-card">
            <h2>Level Settings</h2>
            <p>Viewers can increase their level by collecting points</p>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; max-width: 600px;">
                <div class="form-group">
                    <label>Level Points</label>
                    <input type="number" value="50" min="1">
                </div>
                <div class="form-group">
                    <label>Level Multiplier</label>
                    <input type="number" value="1.03" min="1" step="0.01">
                </div>
            </div>
        </div>
        
        <!-- OBS Connection -->
        <div class="setup-card">
            <h2>OBS Connection</h2>
            <p>Control OBS to switch scenes and sources automatically. Requires OBS 28 or newer!</p>
            
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; max-width: 600px;">
                <div class="form-group">
                    <label>IP</label>
                    <input type="text" value="127.0.0.1">
                </div>
                <div class="form-group">
                    <label>Port</label>
                    <input type="number" value="4455">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" placeholder="Optional">
                </div>
            </div>
            
            <div class="info-box">
                <p><i class="fas fa-info-circle"></i> In OBS: Tools > WebSocket Server Settings > Enable WebSocket Server</p>
            </div>
        </div>
        
        <!-- Minecraft Connection -->
        <div class="setup-card">
            <h2>Minecraft Connection</h2>
            <p>Control Minecraft to summon Mobs or execute custom commands</p>
            
            <div class="form-group">
                <label>Player Name (Optional)</label>
                <input type="text" placeholder="Leave blank for @a">
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; max-width: 600px;">
                <div class="form-group">
                    <label>IP</label>
                    <input type="text" value="127.0.0.1">
                </div>
                <div class="form-group">
                    <label>Port</label>
                    <input type="number" value="4567">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="text" value="change_me">
                </div>
            </div>
        </div>
        
        <!-- Advanced Settings -->
        <div class="setup-card">
            <h2>Advanced Settings</h2>
            
            <div class="form-group">
                <label>TikTok Language</label>
                <input type="text" value="tr-TR" placeholder="en-US" style="max-width: 200px;">
                <p style="font-size: 0.85em; color: #888; margin-top: 5px;">Relevant for localized gifts. Example: en-US</p>
            </div>
        </div>
        
        <!-- Save All -->
        <div class="setup-card" style="text-align: center;">
            <button class="btn btn-primary" style="font-size: 1.1em; padding: 15px 40px;">
                <i class="fas fa-save"></i> Save All Settings
            </button>
        </div>
        
        <!-- Quick Start -->
        <div class="setup-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <h2 style="color: white;">üöÄ Quick Start</h2>
            <p style="color: rgba(255,255,255,0.9);">Ready to go? Start monitoring your live stream now!</p>
            
            <button class="btn" style="background: white; color: #667eea;" onclick="goToDashboard()">
                <i class="fas fa-play"></i> Go to Dashboard
            </button>
        </div>
    </div>

    <script>
        function saveTikTokUsername() {
            const username = document.getElementById('tiktokUsername').value.trim().replace('@', '');
            
            if (!username) {
                alert('Please enter your TikTok username');
                return;
            }
            
            // Save to session/cookie
            localStorage.setItem('tiktok_username', username);
            
            alert('‚úÖ TikTok username saved: @' + username);
        }
        
        function goToDashboard() {
            const username = localStorage.getItem('tiktok_username');
            
            if (!username) {
                alert('‚ö†Ô∏è Please enter your TikTok username first');
                return;
            }
            
            window.location.href = '/tiktok/';
        }
        
        // Load saved username
        window.onload = function() {
            const saved = localStorage.getItem('tiktok_username');
            if (saved) {
                document.getElementById('tiktokUsername').value = saved;
            }
        };
    </script>
</body>
</html>
